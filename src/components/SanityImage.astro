---
import { createImageUrlBuilder } from '@sanity/image-url';
import { sanityClient } from 'sanity:client';
import type { ImageWithMeta } from '~/types/global';

export interface Props {
  className?: string | string[];
  image: ImageWithMeta;
}

const { className, image, ...props } = Astro.props;

const imageBuilder = createImageUrlBuilder(sanityClient).fit('max').format('webp');

function urlFor(source: ImageWithMeta) {
  return imageBuilder.image(source).url();
}
---

<img
  alt={image?.alt || ''}
  class:list={[
    'max-h-[95vh] object-cover bg-gray-900',
    className,
  ]}
  src={urlFor(image)}
  title={image?.alt}
  width={image.asset.metadata?.dimensions?.width}
  height={image.asset.metadata?.dimensions?.height}
  {...props}
/>
